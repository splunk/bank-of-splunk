# Python logging configuration file
# Reference: https://docs.python.org/3/library/logging.config.html#configuration-file-format
#
# NOTE: This file is NOT used - logging is configured programmatically in frontend.py
# Reason: gunicorn logs messages before create_app() runs, so the deployment_environment
# attribute would not be available yet, causing KeyError exceptions.
# This file is kept for documentation/reference purposes only.

[loggers]
keys=root,gunicorn.error,gunicorn.access,frontend

[handlers]
keys=console

[formatters]
keys=json

# ============================================================================
# LOGGERS
# ============================================================================
# Loggers define WHAT gets logged and at what level.
# They reference handlers (WHERE to send logs) but NOT formatters directly.
# ============================================================================

[logger_root]
level=INFO
handlers=console

[logger_gunicorn.error]
level=INFO
handlers=console
propagate=0
qualname=gunicorn.error

[logger_gunicorn.access]
level=INFO
handlers=console
propagate=0
qualname=gunicorn.access

[logger_frontend]
level=INFO
handlers=console
propagate=0
qualname=frontend

# ============================================================================
# HANDLERS
# ============================================================================
# Handlers define WHERE logs go (console, file, etc.) and HOW they're formatted.
# The formatter is specified HERE on the handler, not on the logger.
# ============================================================================

[handler_console]
class=StreamHandler
level=DEBUG
formatter=json
args=(sys.stdout,)

# ============================================================================
# FORMATTERS
# ============================================================================
# Formatters define the OUTPUT FORMAT of log messages.
#
# Available LogRecord attributes (use as %(name)s):
#   asctime      - Human-readable time
#   created      - Time as float (seconds since epoch)
#   filename     - Filename portion of pathname
#   funcName     - Name of function containing the logging call
#   levelname    - Text logging level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
#   levelno      - Numeric logging level
#   lineno       - Source line number where logging call was issued
#   message      - The logged message
#   module       - Module name
#   name         - Logger name
#   pathname     - Full pathname of source file
#   process      - Process ID
#   processName  - Process name
#   thread       - Thread ID
#   threadName   - Thread name
#
# OpenTelemetry adds these attributes (when instrumentation is enabled):
#   otelTraceID          - Trace ID
#   otelSpanID           - Span ID
#   otelServiceName      - Service name from OTEL_SERVICE_NAME
#   otelTraceSampled     - Whether trace is sampled
#
# Custom attributes injected by frontend.py via logging.Filter:
#   deployment_environment - Parsed from OTEL_RESOURCE_ATTRIBUTES
# ============================================================================

[formatter_json]
format={"timestamp": "%(asctime)s", "message": "%(funcName)s | %(message)s", "filename": "%(filename)s", "lineno": %(lineno)d, "trace_id": "%(otelTraceID)s", "span_id": "%(otelSpanID)s", "service.name": "%(otelServiceName)s", "deployment.environment": "%(deployment_environment)s", "severity": "%(levelname)s"}
datefmt=%Y-%m-%d %H:%M:%S
class=logging.Formatter


